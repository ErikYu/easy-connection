{"version":3,"file":"index.js","sources":["../../src/connector.model.ts","../../src/utils.ts","../../src/constraints.ts","../../src/helpers/pointer-helper.ts","../../src/helpers/element-position-helper.ts","../../src/helpers/svg-helper.ts","../../src/connector.ts","../../src/connector-base.ts","../../src/draggable.ts","../../src/connector-flowchart.ts","../../src/connectable.ts","../../src/connection.ts"],"sourcesContent":["// The preset position of the ConnectorPointer\n// `vertical` contains `bottom` & `top`\n// `horizontal` contains `left` & `right`\n// When `auto`, the position will change according to the relative position\n// The default value is `auto`\nexport type ConnectorPointerPosition = 'vertical' | 'horizontal' | 'auto';\nexport type ConnectionType = 'stateMachine' | 'straight';\n\ntype PromiseOr<T> = Promise<T> | T;\n\nexport interface ConnectorOptions {\n  pointerSize?: number;\n  strokeWidth?: number;\n  color?: string;\n\n  // When mouseover the connection, the line's color changes into `hoverColor`\n  hoverColor?: string;\n  arrowSize?: number;\n\n  // The connect-pointer's position\n  pointerPosition?: ConnectorPointerPosition;\n}\n\nexport interface EasyConnectionOptions extends ConnectorOptions {\n  type: ConnectionType;\n}\n\nexport enum StartPositionEnum {\n  horizontalLeftTop,\n  horizontalLeftBottom,\n  horizontalRightTop,\n  horizontalRightBottom,\n  verticalLeftTop,\n  verticalLeftBottom,\n  verticalRightTop,\n  verticalRightBottom,\n}\n\nexport interface SvgCanvasParameters {\n  height: number;\n  width: number;\n  leftTop: number[];\n  leftBottom: number[];\n  rightTop: number[];\n  rightBottom: number[];\n}\n\nexport interface DrawPath {\n  drawPath: () => void;\n}\n\nexport interface DrawEndArrow {\n  drawEndArrow: () => void;\n}\n\nexport interface DragOptions extends ConnectorOptions {\n  type: ConnectionType;\n  // TODO\n  onBeforeDrag?: () => PromiseOr<boolean>;\n\n  onDragging?: () => void;\n}\n\nexport interface DomConnection {\n  start: HTMLElement;\n  end: HTMLElement;\n}\n","import { ConnectorOptions } from './connector.model';\n\ninterface IndexedObject {\n  [a: string]: string;\n}\n\ninterface PolylineEvents {\n  onmouseenter?: (event: MouseEvent) => void;\n  onmouseleave?: (event: MouseEvent) => void;\n  onmousedown?: (event: MouseEvent) => void;\n}\n\ntype svgElement = 'path' | 'polyline';\n\nexport function createSvgElement(label: svgElement, styleMap: IndexedObject) {\n  const elem = document.createElementNS('http://www.w3.org/2000/svg', label);\n  Object.keys(styleMap).forEach(key => {\n    elem.setAttributeNS(null, key, styleMap[key]);\n  });\n  return elem;\n}\n\nexport function createPolyline(\n  options: ConnectorOptions,\n  { onmouseenter, onmouseleave, onmousedown }: PolylineEvents,\n): SVGPolylineElement {\n  const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');\n  polyline.setAttributeNS(null, 'fill', 'none');\n  polyline.setAttributeNS(null, 'stroke', `${options.color}`);\n  polyline.setAttributeNS(null, 'stroke-width', `${options.strokeWidth}`);\n  polyline.onmouseenter = onmouseenter;\n  polyline.onmouseleave = onmouseleave;\n  polyline.onmousedown = onmousedown;\n  return polyline;\n}\n\nexport function straightPolyline(polyLine: SVGPolylineElement, start: number[], end: number[]) {\n  polyLine.setAttributeNS(null, 'points', `${start.toString()} ${end.toString()}`);\n}\n\nexport function stateMachinePolyLine(\n  polyLine: SVGPolylineElement,\n  start: number[],\n  midA: number[],\n  midB: number[],\n  end: number[],\n) {\n  polyLine.setAttributeNS(\n    null,\n    'points',\n    `${start.toString()} ${midA.toString()} ${midB.toString()} ${end.toString()}`,\n  );\n}\n\nexport function px2num(pxVal: string): number {\n  return +pxVal.slice(0, pxVal.length - 2);\n}\n\nexport function num2px(numVal: number): string {\n  return `${numVal}px`;\n}\n\n/**\n * add class names for a html element, when the element already has the className, skip\n * @param elem target html element\n * @param cls classNames or className\n */\nexport function addClassIfNotExist(elem: Element, cls: string[] | string): void {\n  const classes = Array.isArray(cls) ? cls : [cls];\n  for (const c of classes) {\n    if (!elem.classList.contains(c)) {\n      elem.classList.add(c);\n    }\n  }\n}\n\nexport function removeClass(elem: Element | Element[], cls: string[] | string): void {\n  const classes = Array.isArray(cls) ? cls : [cls];\n  const elements = Array.isArray(elem) ? elem : [elem];\n  for (const e of elements) {\n    for (const c of classes) {\n      e.classList.remove(c);\n    }\n  }\n}\n\n/**\n * Check if two HTML elements is Overlapping one by one\n * @param elemA first element\n * @param elemB second element\n */\nexport function ifOverlapping(elemA, elemB): boolean {\n  const rect1 = elemA.getBoundingClientRect();\n  const rect2 = elemB.getBoundingClientRect();\n  return !(\n    rect1.right < rect2.left ||\n    rect1.left > rect2.right ||\n    rect1.bottom < rect2.top ||\n    rect1.top > rect2.bottom\n  );\n}\n\nexport function setStyle(elem: HTMLElement, style: Partial<CSSStyleDeclaration>) {\n  Object.keys(style).forEach(key => {\n    elem.style[key] = style[key];\n  });\n}\n","export const prefixCls = 'cnt';\n","import { StartPositionEnum } from '../connector.model';\n\nfunction getConnectionPointCoordinate(\n  startPosition: StartPositionEnum,\n  startElement: HTMLElement,\n  endElement: HTMLElement,\n  pointerSize: number,\n) {\n  switch (startPosition) {\n    case StartPositionEnum.horizontalLeftTop:\n    case StartPositionEnum.horizontalLeftBottom:\n      return {\n        startLeft: `${startElement.getBoundingClientRect().width}px`,\n        startTop: `${startElement.getBoundingClientRect().height / 2 - pointerSize / 2}px`,\n        endLeft: `${-pointerSize}px`,\n        entTop: `${endElement.getBoundingClientRect().height / 2 - pointerSize / 2}px`,\n      };\n    case StartPositionEnum.horizontalRightBottom:\n    case StartPositionEnum.horizontalRightTop:\n      return {\n        startLeft: `${-pointerSize}px`,\n        startTop: `${startElement.getBoundingClientRect().height / 2 - pointerSize / 2}px`,\n        endLeft: `${endElement.getBoundingClientRect().width}px`,\n        entTop: `${endElement.getBoundingClientRect().height / 2 - pointerSize / 2}px`,\n      };\n    case StartPositionEnum.verticalLeftTop:\n    case StartPositionEnum.verticalRightTop:\n      // startElem -> bottom\n      // endElem   -> top\n      return {\n        startLeft: `${startElement.getBoundingClientRect().width / 2 - pointerSize / 2}px`,\n        startTop: `${startElement.getBoundingClientRect().height}px`,\n        endLeft: `${endElement.getBoundingClientRect().width / 2 - pointerSize / 2}px`,\n        entTop: `${-pointerSize}px`,\n      };\n    case StartPositionEnum.verticalLeftBottom:\n    case StartPositionEnum.verticalRightBottom:\n      // startElem -> top\n      // endElem   -> bottom\n      return {\n        startLeft: `${startElement.getBoundingClientRect().width / 2 - pointerSize / 2}px`,\n        startTop: `-${pointerSize}px`,\n        endLeft: `${endElement.getBoundingClientRect().width / 2 - pointerSize / 2}px`,\n        entTop: `${endElement.getBoundingClientRect().height}px`,\n      };\n  }\n}\n\nexport { getConnectionPointCoordinate };\n","import { ConnectorPointerPosition, StartPositionEnum } from '../connector.model';\n\nfunction _horizontalHandler(xDistance: number, yDistance: number): StartPositionEnum {\n  if (xDistance <= 0 && yDistance <= 0) {\n    return StartPositionEnum.horizontalLeftTop;\n  } else if (xDistance <= 0 && yDistance > 0) {\n    return StartPositionEnum.horizontalLeftBottom;\n  } else if (xDistance > 0 && yDistance <= 0) {\n    return StartPositionEnum.horizontalRightTop;\n  } else {\n    return StartPositionEnum.horizontalRightBottom;\n  }\n}\n\nfunction _verticalHandler(xDistance: number, yDistance: number): StartPositionEnum {\n  if (xDistance <= 0 && yDistance <= 0) {\n    return StartPositionEnum.verticalLeftTop;\n  } else if (xDistance <= 0 && yDistance > 0) {\n    return StartPositionEnum.verticalLeftBottom;\n  } else if (xDistance > 0 && yDistance <= 0) {\n    return StartPositionEnum.verticalRightTop;\n  } else {\n    return StartPositionEnum.verticalRightBottom;\n  }\n}\n\nfunction getStartPosition(\n  xDistance: number,\n  yDistance: number,\n  pointerPosition: ConnectorPointerPosition,\n): StartPositionEnum {\n  switch (pointerPosition) {\n    case 'auto':\n      return Math.abs(xDistance) >= Math.abs(yDistance)\n        ? _horizontalHandler(xDistance, yDistance)\n        : _verticalHandler(xDistance, yDistance);\n    case 'horizontal':\n      return _horizontalHandler(xDistance, yDistance);\n    case 'vertical':\n    default:\n      return _verticalHandler(xDistance, yDistance);\n  }\n}\n\nexport { getStartPosition };\n","import { ConnectorPoint } from '../connector-point';\nimport { StartPositionEnum } from '../connector.model';\n\n/**\n * Create a svg area used for the connection line between the start and end point\n * the area is rect\n */\nfunction createSvgArea(\n  startPosition: StartPositionEnum,\n  startPointer: ConnectorPoint,\n  endPointer: ConnectorPoint,\n  options,\n) {\n  const svgElement = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  svgElement.innerHTML = `\n    <defs>\n      <marker id=\"markerEndArrow\" viewBox=\"0 0 30 30\" refX=\"9\" refY=\"3\"  markerUnits=\"strokeWidth\" markerWidth=\"30\" markerHeight=\"30\" orient=\"auto\">\n        <path style=\"fill:${options.color};opacity:1\" d=\"M0,0 0,6 9,3z\" />\n      </marker>\n    </defs>`;\n  // set svg position\n  // use position attribute to handle with ethe position\n  svgElement.style.position = 'absolute';\n  svgElement.style.zIndex = '999';\n  svgElement.style.overflow = 'visible';\n  const { offsetLeft: startOffsetLeft, offsetTop: startOffsetTop } = _getTotalOffset(startPointer);\n  const { offsetLeft: endOffsetLeft, offsetTop: endOffsetTop } = _getTotalOffset(endPointer);\n\n  switch (startPosition) {\n    case StartPositionEnum.horizontalLeftTop:\n    case StartPositionEnum.verticalLeftTop:\n      svgElement.style.left = `${startOffsetLeft}px`;\n      svgElement.style.top = `${startOffsetTop}px`;\n      break;\n    case StartPositionEnum.horizontalRightTop:\n    case StartPositionEnum.verticalRightTop:\n      svgElement.style.left = `${endOffsetLeft}px`;\n      svgElement.style.top = `${startOffsetTop}px`;\n      break;\n    case StartPositionEnum.horizontalLeftBottom:\n    case StartPositionEnum.verticalLeftBottom:\n      svgElement.style.left = `${startOffsetLeft}px`;\n      svgElement.style.top = `${endOffsetTop}px`;\n      break;\n    case StartPositionEnum.horizontalRightBottom:\n    case StartPositionEnum.verticalRightBottom:\n      svgElement.style.left = `${endOffsetLeft}px`;\n      svgElement.style.top = `${endOffsetTop}px`;\n      break;\n  }\n\n  const width = Math.abs(startOffsetLeft - endOffsetLeft) + options.pointerSize;\n  const height = Math.abs(startOffsetTop - endOffsetTop) + options.pointerSize;\n  svgElement.setAttribute('width', `${width}px`);\n  svgElement.setAttribute('height', `${height}px`);\n  return svgElement;\n}\n\nfunction _getTotalOffset(pointer: ConnectorPoint) {\n  const offsetLeft = pointer.offsetLeft + (pointer.offsetParent as HTMLElement).offsetLeft;\n  const offsetTop = pointer.offsetTop + (pointer.offsetParent as HTMLElement).offsetTop;\n  return {\n    offsetLeft,\n    offsetTop,\n  };\n}\n\nexport { createSvgArea };\n","import { ConnectorOptions, StartPositionEnum, SvgCanvasParameters } from './connector.model';\nimport { addClassIfNotExist, removeClass, setStyle } from './utils';\nimport { prefixCls } from './constraints';\nimport { ConnectorPoint } from './connector-point';\n\nimport { getConnectionPointCoordinate } from './helpers/pointer-helper';\nimport { getStartPosition } from './helpers/element-position-helper';\nimport { createSvgArea } from './helpers/svg-helper';\n\n/**\n * The root class of connection\n */\nexport abstract class Connector {\n  options: ConnectorOptions;\n\n  // The container of the zone, every thing is on it\n  playground: HTMLElement;\n\n  // The start HTMLElement of the connection\n  startElement: HTMLElement;\n\n  // The end HTMLElement of the connection\n  endElement: HTMLElement;\n\n  // The element that attached on the start/end element\n  // usually, there will be 4 most on each element, one at each side\n  startPointer: ConnectorPoint;\n  endPointer: ConnectorPoint;\n\n  // describes where the start element is related to the end element\n  startPosition: StartPositionEnum;\n\n  // the svg container, each connector has one svg\n  svgElement: SVGSVGElement;\n  svgParameters: SvgCanvasParameters;\n\n  isMoving = false;\n  helperPointer: HTMLElement;\n\n  /**\n   * @param playground start connector\n   * @param startElement start connector\n   * @param endElement end connector\n   * @param options end connector\n   */\n  protected constructor(\n    playground: HTMLElement,\n    startElement: HTMLElement,\n    endElement: HTMLElement,\n    options: ConnectorOptions,\n  ) {\n    this.options = options;\n    this.startElement = startElement;\n    this.endElement = endElement;\n    addClassIfNotExist(startElement, `${prefixCls}-element`);\n    addClassIfNotExist(endElement, `${prefixCls}-element`);\n    this.playground = playground;\n\n    // find the connect point that used in each element\n    const res = this.createConnectPoint(this.startElement, this.endElement);\n    this.startPointer = res.start;\n    this.endPointer = res.end;\n    addClassIfNotExist(this.startPointer, `${prefixCls}-pointer`);\n    addClassIfNotExist(this.endPointer, `${prefixCls}-pointer`);\n\n    // create a svg area between start and end\n    this.svgElement = this.createSvgArea();\n    this.drawPath();\n    this.playground.appendChild(this.svgElement);\n  }\n\n  /**\n   * Remove and render the svg part\n   * TODO: more efficient way should be used here\n   */\n  public renderLine() {\n    const res = this.createConnectPoint(this.startElement, this.endElement);\n    this.startPointer = res.start;\n    this.endPointer = res.end;\n    addClassIfNotExist(this.startPointer, `${prefixCls}-pointer`);\n    addClassIfNotExist(this.endPointer, `${prefixCls}-pointer`);\n    this.playground.removeChild(this.svgElement);\n    this.svgElement = this.createSvgArea();\n    this.drawPath();\n    this.playground.appendChild(this.svgElement);\n  }\n\n  /**\n   * remove the whole svg part and the connect pointer\n   */\n  public dispose() {\n    if (this.startElement && this.startPointer) {\n      this.startElement.removeChild(this.startPointer);\n    }\n    if (this.endElement && this.endPointer) {\n      this.endElement.removeChild(this.endPointer);\n    }\n    this.playground.removeChild(this.svgElement);\n  }\n\n  abstract drawPath(): void;\n\n  private createConnectPoint(startElement: HTMLElement, endElement: HTMLElement) {\n    if (!!this.startPointer) {\n      startElement.removeChild(this.startPointer);\n    }\n    if (!!this.endPointer) {\n      endElement.removeChild(this.endPointer);\n    }\n    // calc the absolute distance between two elements\n    // should notice that the area depends on the endElement position related to the start element\n    const startPointer = document.createElement('div');\n    const endPointer = document.createElement('div');\n\n    startPointer.style.position = 'absolute';\n    endPointer.style.position = 'absolute';\n    startPointer.style.backgroundColor = '#000000';\n    endPointer.style.backgroundColor = '#000000';\n    startPointer.style.width = `${this.options.pointerSize}px`;\n    endPointer.style.width = `${this.options.pointerSize}px`;\n    startPointer.style.height = `${this.options.pointerSize}px`;\n    endPointer.style.height = `${this.options.pointerSize}px`;\n\n    const xDistance = startElement.offsetLeft - endElement.offsetLeft;\n    const yDistance = startElement.offsetTop - endElement.offsetTop;\n\n    this.startPosition = getStartPosition(xDistance, yDistance, this.options.pointerPosition);\n\n    const { startLeft, startTop, endLeft, entTop } = getConnectionPointCoordinate(\n      this.startPosition,\n      startElement,\n      endElement,\n      this.options.pointerSize,\n    );\n    startPointer.style.left = startLeft;\n    startPointer.style.top = startTop;\n    endPointer.style.left = endLeft;\n    endPointer.style.top = entTop;\n\n    startElement.appendChild(startPointer);\n    endElement.appendChild(endPointer);\n    return {\n      start: (startPointer as unknown) as ConnectorPoint,\n      end: (endPointer as unknown) as ConnectorPoint,\n    };\n  }\n\n  /**\n   * Create a svg area used for the connection line between the start and end point\n   * the area is rect\n   */\n  private createSvgArea() {\n    const svgElement = createSvgArea(this.startPosition, this.startPointer, this.endPointer, this.options);\n    const svgWidth: number = svgElement.width.baseVal.valueInSpecifiedUnits;\n    const svgHeight: number = svgElement.height.baseVal.valueInSpecifiedUnits;\n\n    this.svgParameters = {\n      height: svgHeight,\n      width: svgWidth,\n      leftTop: [this.options.pointerSize / 2, this.options.pointerSize / 2],\n      leftBottom: [this.options.pointerSize / 2, svgHeight - this.options.pointerSize / 2],\n      rightTop: [svgWidth - this.options.pointerSize / 2, this.options.pointerSize / 2],\n      rightBottom: [svgWidth - this.options.pointerSize / 2, svgHeight - this.options.pointerSize / 2],\n    };\n    return svgElement;\n  }\n\n  getTotalOffset(pointer: ConnectorPoint) {\n    const offsetLeft = pointer.offsetLeft + (pointer.offsetParent as HTMLElement).offsetLeft;\n    const offsetTop = pointer.offsetTop + (pointer.offsetParent as HTMLElement).offsetTop;\n    return {\n      offsetLeft,\n      offsetTop,\n    };\n  }\n\n  private checkIfMouseEventOnArrow(event: MouseEvent): boolean {\n    const isNear = (a, b) => Math.abs(a - b) < 50;\n    const { offsetX, offsetY } = event;\n    const mapping = {\n      [StartPositionEnum.horizontalLeftTop]: 'rightBottom',\n      [StartPositionEnum.verticalLeftTop]: 'rightBottom',\n    };\n    const [arrowX, arrowY] = this.svgParameters[mapping[this.startPosition]];\n    return isNear(offsetX, arrowX) && isNear(offsetY, arrowY);\n  }\n\n  // Functions that can be inherited or override\n  // Used for the children classes, ep: ConnectorBase, ConnectorFlowchart...\n\n  /**\n   * When mouse move into the connection, the hover color shall be changed\n   * @param event: MouseEvent\n   */\n  onmouseenter = (event: MouseEvent) => {\n    const polyline = event.target as HTMLElement;\n    const hoverColor = this.options.hoverColor || this.options.color;\n    polyline.style.stroke = hoverColor;\n    this.svgElement.getElementById('markerEndArrow').getElementsByTagName('path')[0].style.fill = hoverColor;\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n\n  /**\n   * When mouse move leave the connection, the hover color shall be changed\n   * @param event: MouseEvent\n   */\n  onmouseleave = (event: MouseEvent) => {\n    (event.target as HTMLElement).style.stroke = this.options.color;\n    this.svgElement.getElementById('markerEndArrow').getElementsByTagName('path')[0].style.fill = this.options.color;\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n\n  /**\n   * While mousedown on then endArrow, the connection should start moving\n   * We can modify the connection to other elements or just destroy the element\n   * @param event: MouseEvent\n   */\n  onmousedown = (event: MouseEvent) => {\n    const isOnArrow = this.checkIfMouseEventOnArrow(event);\n    if (isOnArrow) {\n      // this connection should be removed and temp lines should be created\n      // build a helper pointer and connect it with the helper point\n      this.isMoving = true;\n      const helperPointOffset = 3;\n      const x: number = event.pageX - this.playground.offsetLeft;\n      const y: number = event.pageY - this.playground.offsetTop;\n      this.helperPointer = document.createElement('div');\n      setStyle(this.helperPointer, {\n        width: '0px',\n        height: '0px',\n        position: 'absolute',\n        left: `${x - helperPointOffset}px`,\n        top: `${y - helperPointOffset}px`,\n      });\n      this.playground.appendChild(this.helperPointer);\n      this.endElement = this.helperPointer;\n      this.endPointer = undefined;\n      // reconnect\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isMoving) {\n          this.helperPointer.style.left = `${_event.pageX - this.playground.offsetLeft - helperPointOffset}px`;\n          this.helperPointer.style.top = `${_event.pageY - this.playground.offsetTop - helperPointOffset}px`;\n          this.renderLine();\n          const elementMouseIsOver = document.elementsFromPoint(_event.clientX, _event.clientY);\n          const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n\n          const allElements = this.playground.getElementsByClassName(`${prefixCls}-element`);\n          if (targetElements.length > 0) {\n            addClassIfNotExist(targetElements[0], `${prefixCls}-will`);\n            // others should be deleted\n            removeClass(Array.from(allElements).filter(i => i !== targetElements[0]), `${prefixCls}-will`);\n          } else {\n            removeClass(Array.from(allElements), `${prefixCls}-will`);\n          }\n        }\n      };\n\n      // TODO: many optimize\n      document.onmouseup = (_upEvent: MouseEvent) => {\n        this.isMoving = false;\n        const elementMouseIsOver = document.elementsFromPoint(_upEvent.clientX, _upEvent.clientY);\n        const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n        if (targetElements.length > 0) {\n          this.endElement = targetElements[0] as HTMLElement;\n          this.endPointer = undefined;\n          this.renderLine();\n          removeClass(targetElements[0], `${prefixCls}-will`);\n        } else {\n          this.dispose();\n        }\n        if (this.helperPointer) {\n          this.playground.removeChild(this.helperPointer);\n          this.helperPointer = undefined;\n        }\n      };\n    }\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n}\n","import { ConnectorOptions, StartPositionEnum, SvgCanvasParameters } from './connector.model';\nimport { prefixCls } from './constraints';\nimport { ConnectorPoint } from './connector-point';\nimport { addClassIfNotExist, createPolyline, removeClass, setStyle, straightPolyline } from './utils';\nimport { Connector } from './connector';\n\nexport class ConnectorBase extends Connector {\n  startPosition: StartPositionEnum;\n\n  // whether the user is moving the arrow\n  isModifyingConnector = false;\n\n  constructor(playground: HTMLElement, startElement: HTMLElement, endElement: HTMLElement, options: ConnectorOptions) {\n    super(playground, startElement, endElement, options);\n  }\n\n  drawPath() {\n    let startCoordinate;\n    let endCoordinate;\n    switch (this.startPosition) {\n      case StartPositionEnum.verticalLeftTop:\n      case StartPositionEnum.horizontalLeftTop:\n        // draw a line from leftTop to rightBottom\n        startCoordinate = this.svgParameters.leftTop;\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.verticalLeftBottom:\n      case StartPositionEnum.horizontalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.verticalRightTop:\n      case StartPositionEnum.horizontalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.verticalRightBottom:\n      case StartPositionEnum.horizontalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        endCoordinate = this.svgParameters.leftTop;\n        break;\n    }\n    const path = createPolyline(this.options, {\n      onmouseenter: this.onmouseenter,\n      onmouseleave: this.onmouseleave,\n      onmousedown: this.onmousedown,\n    });\n    straightPolyline(path, startCoordinate, endCoordinate);\n    path.style.markerEnd = 'url(#markerEndArrow)';\n    this.svgElement.appendChild(path);\n  }\n}\n","import { px2num, num2px } from './utils';\nimport { prefixCls } from './constraints';\nimport { DragOptions } from './connector.model';\n\ninterface Coordinate {\n  xPos: number;\n  yPos: number;\n}\n\nexport class Draggable {\n  elem: HTMLElement;\n  isDragging = false;\n  dragOptions: DragOptions;\n\n  startCoordinate: Coordinate;\n  elemStartCoordinate: Coordinate;\n\n  constructor(elem: HTMLElement, dragOptions: DragOptions) {\n    this.elem = elem;\n    this.dragOptions = dragOptions || { type: 'straight' };\n    this.makeItDraggable();\n    this.elemStartCoordinate = {\n      xPos: px2num(getComputedStyle(this.elem).left),\n      yPos: px2num(getComputedStyle(this.elem).top),\n    };\n  }\n\n  private makeItDraggable() {\n    this.elem.style.position = 'absolute';\n    this.elem.onmousedown = (event: MouseEvent) => {\n      this.startCoordinate = {\n        xPos: event.clientX,\n        yPos: event.clientY,\n      };\n      this.isDragging = true;\n\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isDragging) {\n          const _diffX = _event.clientX - this.startCoordinate.xPos;\n          const _diffY = _event.clientY - this.startCoordinate.yPos;\n          this.elem.style.left = num2px(this.elemStartCoordinate.xPos + _diffX);\n          this.elem.style.top = num2px(this.elemStartCoordinate.yPos + _diffY);\n          if (typeof this.dragOptions.onDragging === 'function') {\n            this.dragOptions.onDragging();\n          }\n        }\n      };\n\n      document.onmouseup = () => {\n        this.isDragging = false;\n        this.startCoordinate = undefined;\n        // new element position should be set\n        this.elemStartCoordinate = {\n          xPos: px2num(getComputedStyle(this.elem).left),\n          yPos: px2num(getComputedStyle(this.elem).top),\n        };\n\n        document.onmousemove = () => {};\n      };\n    };\n  }\n}\n","import { ConnectorOptions, StartPositionEnum, DrawPath } from './connector.model';\nimport { createPolyline, stateMachinePolyLine } from './utils';\nimport { Connector } from './connector';\n\nexport class ConnectorFlowchart extends Connector implements DrawPath {\n  constructor(playground: HTMLElement, startPoint: HTMLElement, endPoint: HTMLElement, options: ConnectorOptions) {\n    super(playground, startPoint, endPoint, options);\n  }\n\n  drawPath() {\n    const svgWidth: number = this.svgElement.width.baseVal.valueInSpecifiedUnits;\n    const svgHeight: number = this.svgElement.height.baseVal.valueInSpecifiedUnits;\n    let startCoordinate;\n    let middleACoordinate;\n    let middleBCoordinate;\n    let endCoordinate;\n    switch (this.startPosition) {\n      case StartPositionEnum.verticalLeftTop:\n        startCoordinate = this.svgParameters.leftTop;\n        middleACoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.horizontalLeftTop:\n        startCoordinate = this.svgParameters.leftTop;\n        middleACoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.verticalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        middleACoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.horizontalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        middleACoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.verticalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        middleACoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.horizontalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        middleACoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.verticalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        middleACoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.leftTop;\n        break;\n      case StartPositionEnum.horizontalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        middleACoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.leftTop;\n    }\n\n    const path = createPolyline(this.options, {\n      onmouseenter: this.onmouseenter,\n      onmouseleave: this.onmouseleave,\n      onmousedown: this.onmousedown,\n    });\n    stateMachinePolyLine(path, startCoordinate, middleACoordinate, middleBCoordinate, endCoordinate);\n    path.style.markerEnd = 'url(#markerEndArrow)';\n    this.svgElement.appendChild(path);\n  }\n}\n","import { Draggable } from './draggable';\nimport { DragOptions } from './connector.model';\nimport { prefixCls } from './constraints';\nimport { ConnectorBase } from './connector-base';\nimport { ConnectorFlowchart } from './connector-flowchart';\nimport { addClassIfNotExist, ifOverlapping, removeClass, setStyle } from './utils';\n\nconst TYPE_MAP = {\n  undefined: ConnectorBase,\n  straight: ConnectorBase,\n  flowchart: ConnectorFlowchart,\n};\n\nexport class Connectable extends Draggable {\n  playground: HTMLElement;\n  nativeElement: HTMLElement;\n  helperPointer: HTMLElement;\n  isCreatingNewConnector = false;\n  onCreatingLine;\n  constructor(playground: HTMLElement, elem: HTMLElement, dragOptions: DragOptions, { onCreatingLine }) {\n    super(elem, dragOptions);\n    this.nativeElement = elem;\n    setStyle(elem, {\n      zIndex: '2',\n    });\n    this.playground = playground;\n    this.onCreatingLine = onCreatingLine;\n    addClassIfNotExist(elem, `${prefixCls}-element`);\n    this.createAnchor();\n  }\n\n  private createAnchor() {\n    const anchor: HTMLElement = document.createElement('div');\n    anchor.classList.add(`${prefixCls}-anchor`);\n    setStyle(anchor, {\n      width: '10px',\n      height: '10px',\n      backgroundColor: 'red',\n      position: 'absolute',\n      left: '15px',\n      top: '15px',\n    });\n\n    // while anchor press down\n    // a new connection will be created\n    anchor.onmousedown = (event: MouseEvent) => {\n      event.stopPropagation();\n      this.isCreatingNewConnector = true;\n\n      // create a overlay entPointer at the click position\n\n      // if offset is 0, the pointer will always hover the helper point instead of the other element\n      const helperPointOffset = 3;\n\n      const x: number = event.pageX - this.playground.offsetLeft;\n      const y: number = event.pageY - this.playground.offsetTop;\n      this.helperPointer = document.createElement('div');\n      setStyle(this.helperPointer, {\n        width: '0px',\n        height: '0px',\n        position: 'absolute',\n        left: `${x - helperPointOffset}px`,\n        top: `${y - helperPointOffset}px`,\n      });\n      this.playground.appendChild(this.helperPointer);\n      let _newConnection = new TYPE_MAP[this.dragOptions.type](\n        this.playground,\n        this.elem,\n        this.helperPointer,\n        this.dragOptions,\n      );\n\n      // TODO: onmousemove and onmouseup's listener should be removed after onmouseup\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isCreatingNewConnector) {\n          this.helperPointer.style.left = `${_event.pageX - this.playground.offsetLeft - helperPointOffset}px`;\n          this.helperPointer.style.top = `${_event.pageY - this.playground.offsetTop - helperPointOffset}px`;\n          if (_newConnection) {\n            _newConnection.renderLine();\n          }\n          const elementMouseIsOver = document.elementsFromPoint(_event.clientX, _event.clientY);\n          const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n\n          const allElements = this.playground.getElementsByClassName(`${prefixCls}-element`);\n          if (targetElements.length > 0) {\n            addClassIfNotExist(targetElements[0], `${prefixCls}-will`);\n            // others should be deleted\n            removeClass(Array.from(allElements).filter(i => i !== targetElements[0]), `${prefixCls}-will`);\n          } else {\n            removeClass(Array.from(allElements), `${prefixCls}-will`);\n          }\n        }\n      };\n      document.onmouseup = (_upEvent: MouseEvent) => {\n        this.isCreatingNewConnector = false;\n        const elementMouseIsOver = document.elementsFromPoint(_upEvent.clientX, _upEvent.clientY);\n        const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n        if (_newConnection) {\n          _newConnection.dispose();\n          _newConnection = null;\n        }\n        if (targetElements.length > 0) {\n          this.onCreatingLine(targetElements[0]);\n          removeClass(targetElements[0], `${prefixCls}-will`);\n        }\n        if (this.helperPointer) {\n          this.playground.removeChild(this.helperPointer);\n          this.helperPointer = undefined;\n        }\n      };\n    };\n\n    this.elem.appendChild(anchor);\n  }\n}\n","import { DomConnection, EasyConnectionOptions } from './connector.model';\nimport { ConnectorBase } from './connector-base';\nimport { Connectable } from './connectable';\nimport { ConnectorFlowchart } from './connector-flowchart';\nimport { ifOverlapping } from './utils';\n\ninterface ElementConnectionsMap {\n  [a: string]: Array<ConnectorBase>;\n}\n\nconst TYPE_MAP = {\n  undefined: ConnectorBase,\n  straight: ConnectorBase,\n  flowchart: ConnectorFlowchart,\n};\n\nexport class EasyConnection {\n  playground: HTMLElement;\n  options: EasyConnectionOptions;\n  connectableElements: Connectable[] = [];\n  connections: ConnectorBase[] = [];\n\n  elementConnectionsMap: ElementConnectionsMap = {};\n\n  constructor(\n    playground: HTMLElement,\n    elements: HTMLElement[] = [],\n    connections: DomConnection[] = [],\n    options: EasyConnectionOptions = { type: 'straight' },\n  ) {\n    this.playground = playground;\n    this.options = {\n      color: '#cccccc',\n      hoverColor: 'red',\n      pointerPosition: 'auto',\n      pointerSize: 4,\n      strokeWidth: 1,\n      arrowSize: 15,\n      ...options,\n    };\n    // set the playground to position relative\n    // init the connections\n    for (const elem of elements) {\n      this.elementConnectionsMap[elem.id] = [];\n    }\n    for (const con of connections) {\n      const connectionInstance = new TYPE_MAP[options.type](playground, con.start, con.end, this.options);\n      this.elementConnectionsMap[con.start.id].push(connectionInstance);\n      this.elementConnectionsMap[con.end.id].push(connectionInstance);\n      this.connections.push(connectionInstance);\n    }\n    for (const elem of elements) {\n      this.connectableElements.push(\n        new Connectable(\n          playground,\n          elem,\n          {\n            ...this.options,\n            onDragging: () => {\n              // all lines connected to this element should be reRendered\n              this.elementConnectionsMap[elem.id].forEach(i => i.renderLine());\n            },\n          },\n          {\n            onCreatingLine: (targetElem: HTMLElement) => {\n              this.addConnection({\n                start: elem,\n                end: targetElem,\n              });\n            },\n          },\n        ),\n      );\n    }\n  }\n\n  addElement(elem: HTMLElement): void {\n    this.elementConnectionsMap[elem.id] = [];\n    this.playground.appendChild(elem);\n    this.connectableElements.push(\n      new Connectable(\n        this.playground,\n        elem,\n        {\n          ...this.options,\n          onDragging: () => {\n            // all lines connected to this element should be reRendered\n            this.elementConnectionsMap[elem.id].forEach(i => i.renderLine());\n          },\n        },\n        {\n          onCreatingLine: (targetElem: HTMLElement) => {\n            this.addConnection({\n              start: elem,\n              end: targetElem,\n            });\n          },\n        },\n      ),\n    );\n  }\n  addConnection(connection: DomConnection): void {\n    const connectionInstance = new TYPE_MAP[this.options.type](\n      this.playground,\n      connection.start,\n      connection.end,\n      this.options,\n    );\n    this.elementConnectionsMap[connection.start.id].push(connectionInstance);\n    this.elementConnectionsMap[connection.end.id].push(connectionInstance);\n    this.connections.push(connectionInstance);\n  }\n}\n"],"names":["StartPositionEnum","createPolyline","options","onmouseenter","onmouseleave","onmousedown","polyline","document","createElementNS","setAttributeNS","color","strokeWidth","straightPolyline","polyLine","start","end","toString","stateMachinePolyLine","midA","midB","px2num","pxVal","slice","length","num2px","numVal","addClassIfNotExist","elem","cls","classes","Array","isArray","c","classList","contains","add","removeClass","elements","e","remove","setStyle","style","Object","keys","forEach","key","prefixCls","getConnectionPointCoordinate","startPosition","startElement","endElement","pointerSize","horizontalLeftTop","horizontalLeftBottom","startLeft","getBoundingClientRect","width","startTop","height","endLeft","entTop","horizontalRightBottom","horizontalRightTop","verticalLeftTop","verticalRightTop","verticalLeftBottom","verticalRightBottom","_horizontalHandler","xDistance","yDistance","_verticalHandler","getStartPosition","pointerPosition","Math","abs","createSvgArea","startPointer","endPointer","svgElement","innerHTML","position","zIndex","overflow","_getTotalOffset","startOffsetLeft","offsetLeft","startOffsetTop","offsetTop","endOffsetLeft","endOffsetTop","left","top","setAttribute","pointer","offsetParent","Connector","playground","isMoving","event","target","hoverColor","stroke","getElementById","getElementsByTagName","fill","isOnArrow","checkIfMouseEventOnArrow","helperPointOffset","x","pageX","y","pageY","helperPointer","createElement","appendChild","undefined","onmousemove","_event","renderLine","elementMouseIsOver","elementsFromPoint","clientX","clientY","targetElements","filter","i","allElements","getElementsByClassName","from","onmouseup","_upEvent","dispose","removeChild","res","createConnectPoint","drawPath","backgroundColor","svgWidth","baseVal","valueInSpecifiedUnits","svgHeight","svgParameters","leftTop","leftBottom","rightTop","rightBottom","isNear","a","b","offsetX","offsetY","mapping","arrowX","arrowY","ConnectorBase","isModifyingConnector","startCoordinate","endCoordinate","path","markerEnd","Draggable","dragOptions","isDragging","type","makeItDraggable","elemStartCoordinate","xPos","getComputedStyle","yPos","_diffX","_diffY","onDragging","ConnectorFlowchart","startPoint","endPoint","middleACoordinate","middleBCoordinate","TYPE_MAP","straight","flowchart","Connectable","onCreatingLine","isCreatingNewConnector","nativeElement","createAnchor","anchor","stopPropagation","_newConnection","EasyConnection","connections","connectableElements","elementConnectionsMap","arrowSize","id","con","connectionInstance","push","targetElem","addConnection","connection"],"mappings":"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"}