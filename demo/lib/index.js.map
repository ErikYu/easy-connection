{"version":3,"file":"index.js","sources":["../../src/connector.model.ts","../../src/utils.ts","../../src/constraints.ts","../../src/connector.ts","../../src/connector-base.ts","../../src/draggable.ts","../../src/connector-flowchart.ts","../../src/connectable.ts","../../src/connection.ts"],"sourcesContent":["export type ConnectorPointPosition = 'top' | 'left' | 'right' | 'bottom';\nexport type ConnectionType = 'stateMachine' | 'straight';\n\ntype PromiseOr<T> = Promise<T> | T;\n\nexport interface ConnectorOptions {\n  pointerSize?: number;\n  strokeWidth?: number;\n  color?: string;\n  hoverColor?: string;\n  arrowSize?: number;\n}\n\nexport interface EasyConnectionOptions extends ConnectorOptions {\n  type: ConnectionType;\n}\n\nexport enum StartPositionEnum {\n  horizontalLeftTop,\n  horizontalLeftBottom,\n  horizontalRightTop,\n  horizontalRightBottom,\n  verticalLeftTop,\n  verticalLeftBottom,\n  verticalRightTop,\n  verticalRightBottom,\n}\n\nexport interface SvgCanvasParameters {\n  height: number;\n  width: number;\n  leftTop: number[];\n  leftBottom: number[];\n  rightTop: number[];\n  rightBottom: number[];\n}\n\nexport interface DrawPath {\n  drawPath: () => void;\n}\n\nexport interface DrawEndArrow {\n  drawEndArrow: () => void;\n}\n\nexport interface DragOptions extends ConnectorOptions {\n  type: ConnectionType;\n  // TODO\n  onBeforeDrag?: () => PromiseOr<boolean>;\n\n  onDragging?: () => void;\n}\n\nexport interface DomConnection {\n  start: HTMLElement;\n  end: HTMLElement;\n}\n","import { ConnectorOptions } from './connector.model';\n\ninterface IndexedObject {\n  [a: string]: string;\n}\n\ninterface PolylineEvents {\n  onmouseenter?: (event: MouseEvent) => void;\n  onmouseleave?: (event: MouseEvent) => void;\n  onmousedown?: (event: MouseEvent) => void;\n}\n\ntype svgElement = 'path' | 'polyline';\n\nexport function createSvgElement(label: svgElement, styleMap: IndexedObject) {\n  const elem = document.createElementNS('http://www.w3.org/2000/svg', label);\n  Object.keys(styleMap).forEach(key => {\n    elem.setAttributeNS(null, key, styleMap[key]);\n  });\n  return elem;\n}\n\nexport function createPolyline(\n  options: ConnectorOptions,\n  { onmouseenter, onmouseleave, onmousedown }: PolylineEvents,\n): SVGPolylineElement {\n  const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');\n  polyline.setAttributeNS(null, 'fill', 'none');\n  polyline.setAttributeNS(null, 'stroke', `${options.color}`);\n  polyline.setAttributeNS(null, 'stroke-width', `${options.strokeWidth}`);\n  polyline.onmouseenter = onmouseenter;\n  polyline.onmouseleave = onmouseleave;\n  polyline.onmousedown = onmousedown;\n  return polyline;\n}\n\nexport function straightPolyline(polyLine: SVGPolylineElement, start: number[], end: number[]) {\n  polyLine.setAttributeNS(null, 'points', `${start.toString()} ${end.toString()}`);\n}\n\nexport function stateMachinePolyLine(\n  polyLine: SVGPolylineElement,\n  start: number[],\n  midA: number[],\n  midB: number[],\n  end: number[],\n) {\n  polyLine.setAttributeNS(\n    null,\n    'points',\n    `${start.toString()} ${midA.toString()} ${midB.toString()} ${end.toString()}`,\n  );\n}\n\nexport function px2num(pxVal: string): number {\n  return +pxVal.slice(0, pxVal.length - 2);\n}\n\nexport function num2px(numVal: number): string {\n  return `${numVal}px`;\n}\n\n/**\n * add class names for a html element, when the element already has the className, skip\n * @param elem target html element\n * @param cls classNames or className\n */\nexport function addClassIfNotExist(elem: Element, cls: string[] | string): void {\n  const classes = Array.isArray(cls) ? cls : [cls];\n  for (const c of classes) {\n    if (!elem.classList.contains(c)) {\n      elem.classList.add(c);\n    }\n  }\n}\n\nexport function removeClass(elem: Element | Element[], cls: string[] | string): void {\n  const classes = Array.isArray(cls) ? cls : [cls];\n  const elements = Array.isArray(elem) ? elem : [elem];\n  for (const e of elements) {\n    for (const c of classes) {\n      e.classList.remove(c);\n    }\n  }\n}\n\n/**\n * Check if two HTML elements is Overlapping one by one\n * @param elemA first element\n * @param elemB second element\n */\nexport function ifOverlapping(elemA, elemB): boolean {\n  const rect1 = elemA.getBoundingClientRect();\n  const rect2 = elemB.getBoundingClientRect();\n  return !(\n    rect1.right < rect2.left ||\n    rect1.left > rect2.right ||\n    rect1.bottom < rect2.top ||\n    rect1.top > rect2.bottom\n  );\n}\n\nexport function setStyle(elem: HTMLElement, style: Partial<CSSStyleDeclaration>) {\n  Object.keys(style).forEach(key => {\n    elem.style[key] = style[key];\n  });\n}\n","export const prefixCls = 'cnt';\n","import { ConnectorOptions, StartPositionEnum, SvgCanvasParameters } from './connector.model';\nimport { addClassIfNotExist, removeClass, setStyle } from './utils';\nimport { prefixCls } from './constraints';\nimport { ConnectorPoint } from './connector-point';\n\n/**\n * The root class of connection\n */\nexport abstract class Connector {\n  options: ConnectorOptions;\n\n  // The container of the zone, every thing is on it\n  playground: HTMLElement;\n\n  // The start HTMLElement of the connection\n  startElement: HTMLElement;\n\n  // The end HTMLElement of the connection\n  endElement: HTMLElement;\n\n  // The element that attached on the start/end element\n  // usually, there will be 4 most on each element, one at each side\n  startPointer: ConnectorPoint;\n  endPointer: ConnectorPoint;\n\n  // describes where the start element is related to the end element\n  startPosition: StartPositionEnum;\n\n  // the svg container, each connector has one svg\n  svgElement: SVGSVGElement;\n  svgParameters: SvgCanvasParameters;\n\n  isMoving = false;\n  helperPointer: HTMLElement;\n\n  /**\n   * @param playground start connector\n   * @param startElement start connector\n   * @param endElement end connector\n   * @param options end connector\n   */\n  protected constructor(\n    playground: HTMLElement,\n    startElement: HTMLElement,\n    endElement: HTMLElement,\n    options: ConnectorOptions,\n  ) {\n    this.options = {\n      pointerSize: 4,\n      strokeWidth: 1,\n      color: '#cccccc',\n      arrowSize: 15,\n      ...options,\n    };\n    this.startElement = startElement;\n    this.endElement = endElement;\n    addClassIfNotExist(startElement, `${prefixCls}-element`);\n    addClassIfNotExist(endElement, `${prefixCls}-element`);\n    this.playground = playground;\n\n    // find the connect point that used in each element\n    const res = this.createConnectPoint(this.startElement, this.endElement);\n    this.startPointer = res.start;\n    this.endPointer = res.end;\n    addClassIfNotExist(this.startPointer, `${prefixCls}-pointer`);\n    addClassIfNotExist(this.endPointer, `${prefixCls}-pointer`);\n\n    // create a svg area between start and end\n    this.svgElement = this.createSvgArea();\n    this.drawPath();\n    this.playground.appendChild(this.svgElement);\n  }\n\n  /**\n   * Remove and render the svg part\n   * TODO: more efficient way should be used here\n   */\n  public renderLine() {\n    const res = this.createConnectPoint(this.startElement, this.endElement);\n    this.startPointer = res.start;\n    this.endPointer = res.end;\n    addClassIfNotExist(this.startPointer, `${prefixCls}-pointer`);\n    addClassIfNotExist(this.endPointer, `${prefixCls}-pointer`);\n    this.playground.removeChild(this.svgElement);\n    this.svgElement = this.createSvgArea();\n    this.drawPath();\n    this.playground.appendChild(this.svgElement);\n  }\n\n  /**\n   * remove the whole svg part and the connect pointer\n   */\n  public dispose() {\n    if (this.startElement && this.startPointer) {\n      this.startElement.removeChild(this.startPointer);\n    }\n    if (this.endElement && this.endPointer) {\n      this.endElement.removeChild(this.endPointer);\n    }\n    this.playground.removeChild(this.svgElement);\n  }\n\n  abstract drawPath(): void;\n\n  private createConnectPoint(startElement: HTMLElement, endElement: HTMLElement) {\n    if (!!this.startPointer) {\n      startElement.removeChild(this.startPointer);\n    }\n    if (!!this.endPointer) {\n      endElement.removeChild(this.endPointer);\n    }\n    // calc the absolute distance between two elements\n    // should notice that the area depends on the endElement position related to the start element\n    const startPointer = document.createElement('div');\n    const endPointer = document.createElement('div');\n\n    startPointer.style.position = 'absolute';\n    endPointer.style.position = 'absolute';\n    startPointer.style.backgroundColor = '#000000';\n    endPointer.style.backgroundColor = '#000000';\n    startPointer.style.width = `${this.options.pointerSize}px`;\n    endPointer.style.width = `${this.options.pointerSize}px`;\n    startPointer.style.height = `${this.options.pointerSize}px`;\n    endPointer.style.height = `${this.options.pointerSize}px`;\n\n    const xDistance = startElement.offsetLeft - endElement.offsetLeft;\n    const yDistance = startElement.offsetTop - endElement.offsetTop;\n\n    if (Math.abs(xDistance) >= Math.abs(yDistance)) {\n      if (xDistance <= 0 && yDistance <= 0) {\n        this.startPosition = StartPositionEnum.horizontalLeftTop;\n      } else if (xDistance <= 0 && yDistance > 0) {\n        this.startPosition = StartPositionEnum.horizontalLeftBottom;\n      } else if (xDistance > 0 && yDistance <= 0) {\n        this.startPosition = StartPositionEnum.horizontalRightTop;\n      } else {\n        this.startPosition = StartPositionEnum.horizontalRightBottom;\n      }\n    } else {\n      if (xDistance <= 0 && yDistance <= 0) {\n        this.startPosition = StartPositionEnum.verticalLeftTop;\n      } else if (xDistance <= 0 && yDistance > 0) {\n        this.startPosition = StartPositionEnum.verticalLeftBottom;\n      } else if (xDistance > 0 && yDistance <= 0) {\n        this.startPosition = StartPositionEnum.verticalRightTop;\n      } else {\n        this.startPosition = StartPositionEnum.verticalRightBottom;\n      }\n    }\n\n    switch (this.startPosition) {\n      case StartPositionEnum.horizontalLeftTop:\n      case StartPositionEnum.horizontalLeftBottom:\n        ((startPointer as unknown) as ConnectorPoint).position = 'right';\n        ((endPointer as unknown) as ConnectorPoint).position = 'left';\n        startPointer.style.left = `${startElement.getBoundingClientRect().width}px`;\n        startPointer.style.top = `${startElement.getBoundingClientRect().height / 2 - this.options.pointerSize / 2}px`;\n        endPointer.style.left = `${-this.options.pointerSize}px`;\n        endPointer.style.top = `${endElement.getBoundingClientRect().height / 2 - this.options.pointerSize / 2}px`;\n        break;\n      case StartPositionEnum.horizontalRightBottom:\n      case StartPositionEnum.horizontalRightTop:\n        ((startPointer as unknown) as ConnectorPoint).position = 'left';\n        ((endPointer as unknown) as ConnectorPoint).position = 'right';\n        startPointer.style.left = `${-this.options.pointerSize}px`;\n        startPointer.style.top = `${startElement.getBoundingClientRect().height / 2 - this.options.pointerSize / 2}px`;\n        endPointer.style.left = `${endElement.getBoundingClientRect().width}px`;\n        endPointer.style.top = `${endElement.getBoundingClientRect().height / 2 - this.options.pointerSize / 2}px`;\n        break;\n      case StartPositionEnum.verticalLeftTop:\n      case StartPositionEnum.verticalRightTop:\n        // startElem -> bottom\n        // endElem   -> top\n        ((startPointer as unknown) as ConnectorPoint).position = 'bottom';\n        ((endPointer as unknown) as ConnectorPoint).position = 'top';\n        startPointer.style.left = `${startElement.getBoundingClientRect().width / 2 - this.options.pointerSize / 2}px`;\n        startPointer.style.top = `${startElement.getBoundingClientRect().height}px`;\n        endPointer.style.left = `${endElement.getBoundingClientRect().width / 2 - this.options.pointerSize / 2}px`;\n        endPointer.style.top = `${-this.options.pointerSize}px`;\n        break;\n      case StartPositionEnum.verticalLeftBottom:\n      case StartPositionEnum.verticalRightBottom:\n        // startElem -> top\n        // endElem   -> bottom\n        ((startPointer as unknown) as ConnectorPoint).position = 'top';\n        ((endPointer as unknown) as ConnectorPoint).position = 'bottom';\n        startPointer.style.left = `${startElement.getBoundingClientRect().width / 2 - this.options.pointerSize / 2}px`;\n        startPointer.style.top = `-${this.options.pointerSize}px`;\n        endPointer.style.left = `${endElement.getBoundingClientRect().width / 2 - this.options.pointerSize / 2}px`;\n        endPointer.style.top = `${endElement.getBoundingClientRect().height}px`;\n        break;\n    }\n\n    startElement.appendChild(startPointer);\n    endElement.appendChild(endPointer);\n    return {\n      start: (startPointer as unknown) as ConnectorPoint,\n      end: (endPointer as unknown) as ConnectorPoint,\n    };\n  }\n\n  /**\n   * Create a svg area used for the connection line between the start and end point\n   * the area is rect\n   */\n  private createSvgArea() {\n    const svgElement = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svgElement.innerHTML = `\n    <defs>\n      <marker id=\"markerEndArrow\" viewBox=\"0 0 30 30\" refX=\"9\" refY=\"3\"  markerUnits=\"strokeWidth\" markerWidth=\"30\" markerHeight=\"30\" orient=\"auto\">\n        <path style=\"fill:${this.options.color};opacity:1\" d=\"M0,0 0,6 9,3z\" />\n      </marker>\n    </defs>`;\n    // set svg position\n    // use position attribute to handle with ethe position\n    svgElement.style.position = 'absolute';\n    svgElement.style.zIndex = '999';\n    svgElement.style.overflow = 'visible';\n\n    const { offsetLeft: startOffsetLeft, offsetTop: startOffsetTop } = this.getTotalOffset(this.startPointer);\n    const { offsetLeft: endOffsetLeft, offsetTop: endOffsetTop } = this.getTotalOffset(this.endPointer);\n\n    switch (this.startPosition) {\n      case StartPositionEnum.horizontalLeftTop:\n      case StartPositionEnum.verticalLeftTop:\n        svgElement.style.left = `${startOffsetLeft}px`;\n        svgElement.style.top = `${startOffsetTop}px`;\n        break;\n      case StartPositionEnum.horizontalRightTop:\n      case StartPositionEnum.verticalRightTop:\n        svgElement.style.left = `${endOffsetLeft}px`;\n        svgElement.style.top = `${startOffsetTop}px`;\n        break;\n      case StartPositionEnum.horizontalLeftBottom:\n      case StartPositionEnum.verticalLeftBottom:\n        svgElement.style.left = `${startOffsetLeft}px`;\n        svgElement.style.top = `${endOffsetTop}px`;\n        break;\n      case StartPositionEnum.horizontalRightBottom:\n      case StartPositionEnum.verticalRightBottom:\n        svgElement.style.left = `${endOffsetLeft}px`;\n        svgElement.style.top = `${endOffsetTop}px`;\n        break;\n    }\n\n    const width = Math.abs(startOffsetLeft - endOffsetLeft) + this.options.pointerSize;\n    const height = Math.abs(startOffsetTop - endOffsetTop) + this.options.pointerSize;\n    svgElement.setAttribute('width', `${width}px`);\n    svgElement.setAttribute('height', `${height}px`);\n\n    const svgWidth: number = svgElement.width.baseVal.valueInSpecifiedUnits;\n    const svgHeight: number = svgElement.height.baseVal.valueInSpecifiedUnits;\n\n    this.svgParameters = {\n      height: svgHeight,\n      width: svgWidth,\n      leftTop: [this.options.pointerSize / 2, this.options.pointerSize / 2],\n      leftBottom: [this.options.pointerSize / 2, svgHeight - this.options.pointerSize / 2],\n      rightTop: [svgWidth - this.options.pointerSize / 2, this.options.pointerSize / 2],\n      rightBottom: [svgWidth - this.options.pointerSize / 2, svgHeight - this.options.pointerSize / 2],\n    };\n    return svgElement;\n  }\n\n  getTotalOffset(pointer: ConnectorPoint) {\n    const offsetLeft = pointer.offsetLeft + (pointer.offsetParent as HTMLElement).offsetLeft;\n    const offsetTop = pointer.offsetTop + (pointer.offsetParent as HTMLElement).offsetTop;\n    return {\n      offsetLeft,\n      offsetTop,\n    };\n  }\n\n  private checkIfMouseEventOnArrow(event: MouseEvent): boolean {\n    const isNear = (a, b) => Math.abs(a - b) < 50;\n    const { offsetX, offsetY } = event;\n    const mapping = {\n      [StartPositionEnum.horizontalLeftTop]: 'rightBottom',\n      [StartPositionEnum.verticalLeftTop]: 'rightBottom',\n    };\n    const [arrowX, arrowY] = this.svgParameters[mapping[this.startPosition]];\n    return isNear(offsetX, arrowX) && isNear(offsetY, arrowY);\n  }\n\n  // Functions that can be inherited or override\n  // Used for the children classes, ep: ConnectorBase, ConnectorFlowchart...\n\n  /**\n   * When mouse move into the connection, the hover color shall be changed\n   * @param event: MouseEvent\n   */\n  onmouseenter = (event: MouseEvent) => {\n    const polyline = event.target as HTMLElement;\n    const hoverColor = this.options.hoverColor || this.options.color;\n    polyline.style.stroke = hoverColor;\n    this.svgElement.getElementById('markerEndArrow').getElementsByTagName('path')[0].style.fill = hoverColor;\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n\n  /**\n   * When mouse move leave the connection, the hover color shall be changed\n   * @param event: MouseEvent\n   */\n  onmouseleave = (event: MouseEvent) => {\n    (event.target as HTMLElement).style.stroke = this.options.color;\n    this.svgElement.getElementById('markerEndArrow').getElementsByTagName('path')[0].style.fill = this.options.color;\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n\n  /**\n   * While mousedown on then endArrow, the connection should start moving\n   * We can modify the connection to other elements or just destroy the element\n   * @param event: MouseEvent\n   */\n  onmousedown = (event: MouseEvent) => {\n    const isOnArrow = this.checkIfMouseEventOnArrow(event);\n    console.log(isOnArrow);\n    if (isOnArrow) {\n      // this connection should be removed and temp lines should be created\n      // build a helper pointer and connect it with the helper point\n      this.isMoving = true;\n      const helperPointOffset = 3;\n      const x: number = event.pageX - this.playground.offsetLeft;\n      const y: number = event.pageY - this.playground.offsetTop;\n      this.helperPointer = document.createElement('div');\n      setStyle(this.helperPointer, {\n        width: '0px',\n        height: '0px',\n        position: 'absolute',\n        left: `${x - helperPointOffset}px`,\n        top: `${y - helperPointOffset}px`,\n      });\n      this.playground.appendChild(this.helperPointer);\n      this.endElement = this.helperPointer;\n      this.endPointer = undefined;\n      // reconnect\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isMoving) {\n          this.helperPointer.style.left = `${_event.pageX - this.playground.offsetLeft - helperPointOffset}px`;\n          this.helperPointer.style.top = `${_event.pageY - this.playground.offsetTop - helperPointOffset}px`;\n          this.renderLine();\n          const elementMouseIsOver = document.elementsFromPoint(_event.clientX, _event.clientY);\n          const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n\n          const allElements = this.playground.getElementsByClassName(`${prefixCls}-element`);\n          if (targetElements.length > 0) {\n            addClassIfNotExist(targetElements[0], `${prefixCls}-will`);\n            // others should be deleted\n            removeClass(Array.from(allElements).filter(i => i !== targetElements[0]), `${prefixCls}-will`);\n          } else {\n            removeClass(Array.from(allElements), `${prefixCls}-will`);\n          }\n        }\n      };\n\n      // TODO: many optimize\n      document.onmouseup = (_upEvent: MouseEvent) => {\n        this.isMoving = false;\n        const elementMouseIsOver = document.elementsFromPoint(_upEvent.clientX, _upEvent.clientY);\n        const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n        if (targetElements.length > 0) {\n          this.endElement = targetElements[0] as HTMLElement;\n          this.endPointer = undefined;\n          this.renderLine();\n          removeClass(targetElements[0], `${prefixCls}-will`);\n        } else {\n          this.dispose();\n        }\n        if (this.helperPointer) {\n          this.playground.removeChild(this.helperPointer);\n          this.helperPointer = undefined;\n        }\n      };\n    }\n    // tslint:disable-next-line: Unnecessary semicolon\n  };\n}\n","import { ConnectorOptions, StartPositionEnum, SvgCanvasParameters } from './connector.model';\nimport { prefixCls } from './constraints';\nimport { ConnectorPoint } from './connector-point';\nimport { addClassIfNotExist, createPolyline, removeClass, setStyle, straightPolyline } from './utils';\nimport { Connector } from './connector';\n\nexport class ConnectorBase extends Connector {\n  startPosition: StartPositionEnum;\n\n  // whether the user is moving the arrow\n  isModifyingConnector = false;\n\n  constructor(playground: HTMLElement, startElement: HTMLElement, endElement: HTMLElement, options: ConnectorOptions) {\n    super(playground, startElement, endElement, options);\n  }\n\n  drawPath() {\n    let startCoordinate;\n    let endCoordinate;\n    switch (this.startPosition) {\n      case StartPositionEnum.verticalLeftTop:\n      case StartPositionEnum.horizontalLeftTop:\n        // draw a line from leftTop to rightBottom\n        startCoordinate = this.svgParameters.leftTop;\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.verticalLeftBottom:\n      case StartPositionEnum.horizontalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.verticalRightTop:\n      case StartPositionEnum.horizontalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.verticalRightBottom:\n      case StartPositionEnum.horizontalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        endCoordinate = this.svgParameters.leftTop;\n        break;\n    }\n    const path = createPolyline(this.options, {\n      onmouseenter: this.onmouseenter,\n      onmouseleave: this.onmouseleave,\n      onmousedown: this.onmousedown,\n    });\n    straightPolyline(path, startCoordinate, endCoordinate);\n    path.style.markerEnd = 'url(#markerEndArrow)';\n    this.svgElement.appendChild(path);\n  }\n}\n","import { px2num, num2px } from './utils';\nimport { prefixCls } from './constraints';\nimport { DragOptions } from './connector.model';\n\ninterface Coordinate {\n  xPos: number;\n  yPos: number;\n}\n\nexport class Draggable {\n  elem: HTMLElement;\n  isDragging = false;\n  dragOptions: DragOptions;\n\n  startCoordinate: Coordinate;\n  elemStartCoordinate: Coordinate;\n\n  constructor(elem: HTMLElement, dragOptions: DragOptions) {\n    this.elem = elem;\n    this.dragOptions = dragOptions || { type: 'straight' };\n    this.makeItDraggable();\n    this.elemStartCoordinate = {\n      xPos: px2num(getComputedStyle(this.elem).left),\n      yPos: px2num(getComputedStyle(this.elem).top),\n    };\n  }\n\n  private makeItDraggable() {\n    this.elem.style.position = 'absolute';\n    this.elem.onmousedown = (event: MouseEvent) => {\n      this.startCoordinate = {\n        xPos: event.clientX,\n        yPos: event.clientY,\n      };\n      this.isDragging = true;\n\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isDragging) {\n          const _diffX = _event.clientX - this.startCoordinate.xPos;\n          const _diffY = _event.clientY - this.startCoordinate.yPos;\n          this.elem.style.left = num2px(this.elemStartCoordinate.xPos + _diffX);\n          this.elem.style.top = num2px(this.elemStartCoordinate.yPos + _diffY);\n          if (typeof this.dragOptions.onDragging === 'function') {\n            this.dragOptions.onDragging();\n          }\n        }\n      };\n\n      document.onmouseup = () => {\n        this.isDragging = false;\n        this.startCoordinate = undefined;\n        // new element position should be set\n        this.elemStartCoordinate = {\n          xPos: px2num(getComputedStyle(this.elem).left),\n          yPos: px2num(getComputedStyle(this.elem).top),\n        };\n\n        document.onmousemove = () => {};\n      };\n    };\n  }\n}\n","import { ConnectorOptions, StartPositionEnum, DrawPath } from './connector.model';\nimport { createPolyline, stateMachinePolyLine } from './utils';\nimport { Connector } from './connector';\n\nexport class ConnectorFlowchart extends Connector implements DrawPath {\n  constructor(playground: HTMLElement, startPoint: HTMLElement, endPoint: HTMLElement, options: ConnectorOptions) {\n    super(playground, startPoint, endPoint, options);\n  }\n\n  drawPath() {\n    const svgWidth: number = this.svgElement.width.baseVal.valueInSpecifiedUnits;\n    const svgHeight: number = this.svgElement.height.baseVal.valueInSpecifiedUnits;\n    let startCoordinate;\n    let middleACoordinate;\n    let middleBCoordinate;\n    let endCoordinate;\n    switch (this.startPosition) {\n      case StartPositionEnum.verticalLeftTop:\n        startCoordinate = this.svgParameters.leftTop;\n        middleACoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.horizontalLeftTop:\n        startCoordinate = this.svgParameters.leftTop;\n        middleACoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.rightBottom;\n        break;\n      case StartPositionEnum.verticalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        middleACoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.horizontalRightTop:\n        startCoordinate = this.svgParameters.rightTop;\n        middleACoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.leftBottom;\n        break;\n      case StartPositionEnum.verticalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        middleACoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.horizontalLeftBottom:\n        startCoordinate = this.svgParameters.leftBottom;\n        middleACoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.rightTop;\n        break;\n      case StartPositionEnum.verticalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        middleACoordinate = [svgWidth - this.options.pointerSize / 2, svgHeight / 2];\n        middleBCoordinate = [this.options.pointerSize / 2, svgHeight / 2];\n        endCoordinate = this.svgParameters.leftTop;\n        break;\n      case StartPositionEnum.horizontalRightBottom:\n        startCoordinate = this.svgParameters.rightBottom;\n        middleACoordinate = [svgWidth / 2, svgHeight - this.options.pointerSize / 2];\n        middleBCoordinate = [svgWidth / 2, this.options.pointerSize / 2];\n        endCoordinate = this.svgParameters.leftTop;\n    }\n\n    const path = createPolyline(this.options, {\n      onmouseenter: this.onmouseenter,\n      onmouseleave: this.onmouseleave,\n      onmousedown: this.onmousedown,\n    });\n    stateMachinePolyLine(path, startCoordinate, middleACoordinate, middleBCoordinate, endCoordinate);\n    path.style.markerEnd = 'url(#markerEndArrow)';\n    this.svgElement.appendChild(path);\n  }\n}\n","import { Draggable } from './draggable';\nimport { DragOptions } from './connector.model';\nimport { prefixCls } from './constraints';\nimport { ConnectorBase } from './connector-base';\nimport { ConnectorFlowchart } from './connector-flowchart';\nimport { addClassIfNotExist, ifOverlapping, removeClass, setStyle } from './utils';\n\nconst TYPE_MAP = {\n  undefined: ConnectorBase,\n  straight: ConnectorBase,\n  flowchart: ConnectorFlowchart,\n};\n\nexport class Connectable extends Draggable {\n  playground: HTMLElement;\n  nativeElement: HTMLElement;\n  helperPointer: HTMLElement;\n  isCreatingNewConnector = false;\n  onCreatingLine;\n  constructor(playground: HTMLElement, elem: HTMLElement, dragOptions: DragOptions, { onCreatingLine }) {\n    super(elem, dragOptions);\n    this.nativeElement = elem;\n    setStyle(elem, {\n      zIndex: '2',\n    });\n    this.playground = playground;\n    this.onCreatingLine = onCreatingLine;\n    addClassIfNotExist(elem, `${prefixCls}-element`);\n    this.createAnchor();\n  }\n\n  private createAnchor() {\n    const anchor: HTMLElement = document.createElement('div');\n    anchor.classList.add(`${prefixCls}-anchor`);\n    setStyle(anchor, {\n      width: '10px',\n      height: '10px',\n      backgroundColor: 'red',\n      position: 'absolute',\n      left: '15px',\n      top: '15px',\n    });\n\n    // while anchor press down\n    // a new connection will be created\n    anchor.onmousedown = (event: MouseEvent) => {\n      event.stopPropagation();\n      this.isCreatingNewConnector = true;\n\n      // create a overlay entPointer at the click position\n\n      // if offset is 0, the pointer will always hover the helper point instead of the other element\n      const helperPointOffset = 3;\n\n      const x: number = event.pageX - this.playground.offsetLeft;\n      const y: number = event.pageY - this.playground.offsetTop;\n      this.helperPointer = document.createElement('div');\n      setStyle(this.helperPointer, {\n        width: '0px',\n        height: '0px',\n        position: 'absolute',\n        left: `${x - helperPointOffset}px`,\n        top: `${y - helperPointOffset}px`,\n      });\n      this.playground.appendChild(this.helperPointer);\n      let _newConnection = new TYPE_MAP[this.dragOptions.type](\n        this.playground,\n        this.elem,\n        this.helperPointer,\n        this.dragOptions,\n      );\n\n      // TODO: onmousemove and onmouseup's listener should be removed after onmouseup\n      document.onmousemove = (_event: MouseEvent) => {\n        if (this.isCreatingNewConnector) {\n          this.helperPointer.style.left = `${_event.pageX - this.playground.offsetLeft - helperPointOffset}px`;\n          this.helperPointer.style.top = `${_event.pageY - this.playground.offsetTop - helperPointOffset}px`;\n          if (_newConnection) {\n            _newConnection.renderLine();\n          }\n          const elementMouseIsOver = document.elementsFromPoint(_event.clientX, _event.clientY);\n          const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n\n          const allElements = this.playground.getElementsByClassName(`${prefixCls}-element`);\n          if (targetElements.length > 0) {\n            addClassIfNotExist(targetElements[0], `${prefixCls}-will`);\n            // others should be deleted\n            removeClass(Array.from(allElements).filter(i => i !== targetElements[0]), `${prefixCls}-will`);\n          } else {\n            removeClass(Array.from(allElements), `${prefixCls}-will`);\n          }\n        }\n      };\n      document.onmouseup = (_upEvent: MouseEvent) => {\n        this.isCreatingNewConnector = false;\n        const elementMouseIsOver = document.elementsFromPoint(_upEvent.clientX, _upEvent.clientY);\n        const targetElements = elementMouseIsOver.filter(i => i.classList.contains('cnt-element'));\n        if (_newConnection) {\n          _newConnection.dispose();\n          _newConnection = null;\n        }\n        if (targetElements.length > 0) {\n          this.onCreatingLine(targetElements[0]);\n          removeClass(targetElements[0], `${prefixCls}-will`);\n        }\n        if (this.helperPointer) {\n          this.playground.removeChild(this.helperPointer);\n          this.helperPointer = undefined;\n        }\n      };\n    };\n\n    this.elem.appendChild(anchor);\n  }\n}\n","import { DomConnection, EasyConnectionOptions } from './connector.model';\nimport { ConnectorBase } from './connector-base';\nimport { Connectable } from './connectable';\nimport { ConnectorFlowchart } from './connector-flowchart';\nimport { ifOverlapping } from './utils';\n\ninterface ElementConnectionsMap {\n  [a: string]: Array<ConnectorBase>;\n}\n\nconst TYPE_MAP = {\n  undefined: ConnectorBase,\n  straight: ConnectorBase,\n  flowchart: ConnectorFlowchart,\n};\n\nexport class EasyConnection {\n  playground: HTMLElement;\n  options: EasyConnectionOptions;\n  connectableElements: Connectable[] = [];\n  connections: ConnectorBase[] = [];\n\n  elementConnectionsMap: ElementConnectionsMap = {};\n\n  constructor(\n    playground: HTMLElement,\n    elements: HTMLElement[] = [],\n    connections: DomConnection[] = [],\n    options: EasyConnectionOptions = { type: 'straight' },\n  ) {\n    this.playground = playground;\n    this.options = {\n      color: '#cccccc',\n      hoverColor: 'red',\n      ...options,\n    };\n    // set the playground to position relative\n    // init the connections\n    for (const elem of elements) {\n      this.elementConnectionsMap[elem.id] = [];\n    }\n    for (const con of connections) {\n      const connectionInstance = new TYPE_MAP[options.type](playground, con.start, con.end, options);\n      this.elementConnectionsMap[con.start.id].push(connectionInstance);\n      this.elementConnectionsMap[con.end.id].push(connectionInstance);\n      this.connections.push(connectionInstance);\n    }\n    for (const elem of elements) {\n      this.connectableElements.push(\n        new Connectable(\n          playground,\n          elem,\n          {\n            ...options,\n            onDragging: () => {\n              // all lines connected to this element should be reRendered\n              this.elementConnectionsMap[elem.id].forEach(i => i.renderLine());\n            },\n          },\n          {\n            onCreatingLine: (targetElem: HTMLElement) => {\n              this.addConnection({\n                start: elem,\n                end: targetElem,\n              });\n            },\n          },\n        ),\n      );\n    }\n  }\n\n  addElement(elem: HTMLElement): void {\n    this.elementConnectionsMap[elem.id] = [];\n    this.playground.appendChild(elem);\n    this.connectableElements.push(\n      new Connectable(\n        this.playground,\n        elem,\n        {\n          ...this.options,\n          onDragging: () => {\n            // all lines connected to this element should be reRendered\n            this.elementConnectionsMap[elem.id].forEach(i => i.renderLine());\n          },\n        },\n        {\n          onCreatingLine: (targetElem: HTMLElement) => {\n            this.addConnection({\n              start: elem,\n              end: targetElem,\n            });\n          },\n        },\n      ),\n    );\n  }\n  addConnection(connection: DomConnection): void {\n    const connectionInstance = new TYPE_MAP[this.options.type](\n      this.playground,\n      connection.start,\n      connection.end,\n      this.options,\n    );\n    this.elementConnectionsMap[connection.start.id].push(connectionInstance);\n    this.elementConnectionsMap[connection.end.id].push(connectionInstance);\n    this.connections.push(connectionInstance);\n  }\n}\n"],"names":["StartPositionEnum","createPolyline","options","onmouseenter","onmouseleave","onmousedown","polyline","document","createElementNS","setAttributeNS","color","strokeWidth","straightPolyline","polyLine","start","end","toString","stateMachinePolyLine","midA","midB","px2num","pxVal","slice","length","num2px","numVal","addClassIfNotExist","elem","cls","classes","Array","isArray","c","classList","contains","add","removeClass","elements","e","remove","setStyle","style","Object","keys","forEach","key","prefixCls","Connector","playground","startElement","endElement","isMoving","event","target","hoverColor","stroke","svgElement","getElementById","getElementsByTagName","fill","isOnArrow","checkIfMouseEventOnArrow","console","log","helperPointOffset","x","pageX","offsetLeft","y","pageY","offsetTop","helperPointer","createElement","width","height","position","left","top","appendChild","endPointer","undefined","onmousemove","_event","renderLine","elementMouseIsOver","elementsFromPoint","clientX","clientY","targetElements","filter","i","allElements","getElementsByClassName","from","onmouseup","_upEvent","dispose","removeChild","pointerSize","arrowSize","res","createConnectPoint","startPointer","createSvgArea","drawPath","backgroundColor","xDistance","yDistance","Math","abs","startPosition","horizontalLeftTop","horizontalLeftBottom","horizontalRightTop","horizontalRightBottom","verticalLeftTop","verticalLeftBottom","verticalRightTop","verticalRightBottom","getBoundingClientRect","innerHTML","zIndex","overflow","getTotalOffset","startOffsetLeft","startOffsetTop","endOffsetLeft","endOffsetTop","setAttribute","svgWidth","baseVal","valueInSpecifiedUnits","svgHeight","svgParameters","leftTop","leftBottom","rightTop","rightBottom","pointer","offsetParent","isNear","a","b","offsetX","offsetY","mapping","arrowX","arrowY","ConnectorBase","isModifyingConnector","startCoordinate","endCoordinate","path","markerEnd","Draggable","dragOptions","isDragging","type","makeItDraggable","elemStartCoordinate","xPos","getComputedStyle","yPos","_diffX","_diffY","onDragging","ConnectorFlowchart","startPoint","endPoint","middleACoordinate","middleBCoordinate","TYPE_MAP","straight","flowchart","Connectable","onCreatingLine","isCreatingNewConnector","nativeElement","createAnchor","anchor","stopPropagation","_newConnection","EasyConnection","connections","connectableElements","elementConnectionsMap","id","con","connectionInstance","push","targetElem","addConnection","connection"],"mappings":"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"}